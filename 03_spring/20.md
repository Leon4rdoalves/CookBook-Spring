<h1>Teste de Software - JUnit 5 - Teste da Interface UsuarioRepository</h1>

A Classe **UsuarioRepositoryTest** ser√° utilizada parta testar a Classe Repository do Usuario. 

1. No lado esquerdo superior, na Guia **Package Explorer**, clique com o bot√£o direito do mouse sobre a Package **com.generation.blogpessoal.repository**, na Source Folder **src/test/java** e clique na op√ß√£o  **New ü°™ Class**.

2. Na janela **New Java Class**, no item **Name**, informe o nome da Classe que ser√° o mesmo nome da Classe Principal (**UsuarioRepository**) + a palavra **Test**, para indicar que se trata de uma Classe de Testes, ou seja, **UsuarioRepositoryTest**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/3YBogQf.png" title="source: imgur.com" width="65%"/></div>

3. Clique no bot√£o **Finish** para concluir.

| <img src="https://i.imgur.com/nSpXEZ0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **IMPORTANTE:** *Toda a Classe de teste deve ter no final do seu nome a palavra Test.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |


| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="320px"/> | <div align="left"> **ATEN√á√ÉO:** *O Teste da Classe UsuarioRepository, na camada Repository, utiliza o Banco de Dados, entretanto ele n√£o criptografa a senha ao gravar um novo usu√°rio no Banco de dados porqu√™ ele n√£o utiliza a Classe de Servi√ßo UsuarioService, ele utiliza o M√©todo save(), da Interface JpaRepository de forma direta.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h3>UsuarioRepositoryTest</h3>

<div align="center"><img src="https://i.imgur.com/34ea1rN.png?1" title="source: imgur.com" /></div>

Na **linha 24** a anota√ß√£o **@SpringBootTest** indica que a Classe UsuarioRepositoryTest √© uma Classe Spring Boot Testing. A Op√ß√£o **environment** indica que caso a porta principal (8080 para uso local) esteja ocupada, o Spring ir√° atribuir uma outra porta automaticamente.

Na **linha 25** a anota√ß√£o **@TestInstance** indica que o Ciclo de vida da Classe de Teste ser√° por Classe.

Nas **linhas 28 e 29** foi foi injetado (**@Autowired**), um objeto da Interface UsuarioRepository para persistir os objetos no Banco de dados de testes.

Entre as **linhas 31 e 42**, o M√©todo **start()**, anotado com a anota√ß√£o **@BeforeAll**, apaga todos os dados da tabela (linha 34), inicializa 4 objetos do tipo Usuario e insere no Banco de dados de testes atrav√©s do M√©todo **.save()** uma √∫nica vez (**Lifecycle.PER_CLASS**). Observe que em todos os Objetos, o Atributo id est√° com o valor 0L, indicando que o Atributo ser√° preenchido automaticamente pelo Banco de dados (substituindo o zero pela Chave prim√°ria) e o L informa que o Atributo √© um Objeto da Classe Long.

<div align="left"><img src="https://i.imgur.com/mw7d1xn.png" title="source: imgur.com" width="30px"/> <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing" target="_blank"><b>Documenta√ß√£o: @SpringBootTest</b></a>

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank"><b>Documenta√ß√£o: @TestInstance</b></a>

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-instance-lifecycle" target="_blank"><b>Documenta√ß√£o: Lifecycle</b></a>

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank"><b>Documenta√ß√£o: @BeforeAll</b></a>
<br />

<h3>M√©todo 01 - Retornar um Usu√°rio</h3>

<div align="center"><img src="https://i.imgur.com/DlUcHm7.png" title="source: imgur.com" width="100%"/></div>

Na **linha 46**, o M√©todo **deveRetornarUmUsuario()** foi antotado com a anota√ß√£o **@Test** que indica que este M√©todo executar√° um teste.

Na **linha 47**, a anota√ß√£o **@DisplayName** configura uma mensagem que ser√° exibida ao inv√©s do nome do M√©todo

Na **linha 50**, o objeto **usuario** recebe o resultado do M√©todo **findByUsuario()**. 

Na **linha 51**, atrav√©s do M√©todo de asser√ß√£o **assertTrue()**, verifica se o usu√°rio cujo e-mail √© ‚Äújoao@email.com.br‚Äù foi encontrado. Se o e-mail for encontrado o resultado do teste ser√°: **Aprovado!**. Caso n√£o encontre, o resultado do teste ser√° : **Falhou!**.

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank"><b>Documenta√ß√£o: @Test</b></a>

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-display-names" target="_blank"><b>Documenta√ß√£o: @DisplayName</b></a>

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html" target="_blank"><b>Documenta√ß√£o: assertTrue</b></a>

<h3>M√©todo 02 - Retornar tr√™s Usu√°rios</h3>

<div align="center"><img src="https://i.imgur.com/zvUOSdS.png" title="source: imgur.com" /></div>

Na **linha 54**, o M√©todo **deveRetornarTresUsuarios()** foi antotado com a anota√ß√£o **@Test** que indica que este M√©todo executar√° um teste.

Na **linha 55**, a anota√ß√£o **@DisplayName** configura uma mensagem que ser√° exibida ao inv√©s do nome do M√©todo

Na **linha 58**, o objeto **listaDeUsuarios** recebe o resultado do M√©todo **findAllByNomeContainingIgnoreCase()**. 

Na **linha 59**, atrav√©s do M√©todo de asser√ß√£o **assertEquals()**, verifica se o tamanho da List √© igual a 3 (quantidade de usu√°rios cadastrados no M√©todo start() cujo sobrenome √© **"Silva"**). O M√©todo <b>size(),</b> (java.util.List), retorna o tamanho da List. Se o tamanho da List for igual 3, o 1¬∞ teste ser√° **Aprovado!**.

Nas **linhas 54 a 56**, atrav√©s do M√©todo de asser√ß√£o **AssertTrue()**, verifica em cada posi√ß√£o da Collection List **listaDeUsuarios** se os usu√°rios, que foram inseridos no Banco de dados atrav√©s no M√©todo start(), foram gravados na mesma sequ√™ncia. 

- O Teste da **linha 60** checar√° se o primeiro usu√°rio inserido (Jo√£o da Silva) est√° na posi√ß√£o 0 da List **listaDeUsuarios** (1¬™ posi√ß√£o da List), 
- O Teste da **linha 61** checar√° se o segundo usu√°rio (Manuela da Silva) est√° na posi√ß√£o 1 da List **listaDeUsuarios** (2¬™ posi√ß√£o da List).
- O Teste da **linha 62** checar√° se o terceiro usu√°rio (Adriana da Silva) est√° na posi√ß√£o 2 da List **listaDeUsuarios** (3¬™ posi√ß√£o da List). 

A posi√ß√£o na List √© obtida atrav√©s do M√©todo **get(int index)** (java.util.List), passando como par√¢metro a posi√ß√£o desejada. O nome do usu√°rio √© obtido atrav√©s do M√©todo **getNome()** da Classe Usuario. Se os tr√™s usu√°rios foram gravados na mesma sequ√™ncia do M√©todo start(), os tr√™s testes ser√£o **Aprovados!**. 

<div align="left"><img src="https://i.imgur.com/AaUP7GB.png" title="source: imgur.com" width="25px"/> <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/Assertions.html" target="_blank"><b>Documenta√ß√£o: assertEquals</b></a>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="30px"/> <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" target="_blank"><b>Documenta√ß√£o: Collection List</b></a>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="30px"/> <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html#size--" target="_blank"><b>Documenta√ß√£o: Collection List - M√©todo Size()</b></a>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="30px"/> <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html#get-int-" target="_blank"><b>Documenta√ß√£o: Collection List - M√©todo get(int index)</b></a>
<br />

| <img src="https://i.imgur.com/nSpXEZ0.png" title="source: imgur.com" width="120px"/> | <p align="justify"> **IMPORTANTE:** cuidado para n√£o confundir o M√©todo get(int index) do pacote java.util.List com o M√©todo get() do pacote java.util.Optional. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="170px"/> | <p align="justify"> **ATEN√á√ÉO:** *Para que o M√©todo **deveRetornarTresUsuarios()** seja aprovado, as 4 asser√ß√µes (linhas 59 a 62) devem ser aprovadas, caso contr√°rio o JUnit indicar√° que o teste Falhou!.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="center"><img src="https://i.imgur.com/jix5xrE.png" title="source: imgur.com" /></div>

Entre as **linhas 66 e 69**, o M√©todo **end()**, anotado com a anota√ß√£o **@AfterAll**, apaga todos os dados da tabela (linha 68), depois que todos os testes foram executados.

Para concluir, n√£o esque√ßa de Salvar o c√≥digo (**File ü°™ Save All**).

| <img src="https://i.imgur.com/L338M2G.png" title="source: imgur.com" width="138px"/> | **DESAFIO:** Fa√ßa algumas altera√ß√µes nos dados dos objetos e/ou escreva outros testes para praticar. A melhor forma de aprender e compreender como funcionam os testes √© praticando!  |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/blob/15-blog_pessoal_junit_02/blogpessoal/src/test/java/com/generation/blogpessoal/repository/UsuarioRepositoryTest.java" target="_blank"><b>C√≥digo fonte: UsuarioRepositoryTest.java</b></a> 
</div>
  
<br /><br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/tree/15-blog_pessoal_junit_02" target="_blank"><b>C√≥digo fonte do projeto</b></a> 
</div>	


<br /> <br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
